package upei.api;

import java.io.PrintStream;

import org.simpleframework.http.Request;
import org.simpleframework.http.Response;
import org.simpleframework.http.Status;

import com.google.gson.Gson;

public class BaseAPI {
	private Request request;
	private Response response;
		
	public BaseAPI(Request request, Response response) {
		this.request = request;
		this.response = response;
	}

	protected void returnSuccessJson(Object object){
		Gson gson = new Gson();
		String json = gson.toJson(object);

		configureJsonWithSatusCode(Status.OK, json);
	}
	
	protected void returnFailJson(){
		configureJsonWithSatusCode(Status.BAD_REQUEST, "{\"Fail\": true}");
	}
	
	private void configureJsonWithSatusCode(Status status, String json) 
	{
		try {
			
			PrintStream body = this.response.getPrintStream();

			this.response.setValue("Content-Type", "application/json");
			this.response.setValue("Server", "TIS II");
			this.response.setDate("Date", System.currentTimeMillis());
			this.response.setDate("Last-Modified", System.currentTimeMillis());
			this.response.setStatus(status);
				
			body.println(json);
			body.close();
			
		} catch (Exception e) {
			e.printStackTrace();
		}
	}
}
